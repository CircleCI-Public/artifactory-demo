version: 2.1
orbs:
  artifactory: circleci/artifactory@0.0.3
  slack:       circleci/slack@0.1.0

workflows:
  build_publish_consume:
    jobs:
      - artifactory/docker-publish:
          name: Standard Docker Build & Publish
          docker-registry: orbdemos-docker.jfrog.io
          repository: docker
          docker-tag: orbdemos-docker.jfrog.io/hello-world-image:1.0-${CIRCLE_BUILD_NUM}
          post-steps:
            - slack/notify:
                message: "${CIRCLE_USERNAME} just published a new Docker image. 
                          See https://circleci.com/workflow-run/${CIRCLE_WORKFLOW_ID}"
